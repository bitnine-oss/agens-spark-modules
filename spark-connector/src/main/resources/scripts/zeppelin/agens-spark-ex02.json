{"paragraphs":[{"text":"import net.bitnine.agens.spark.AgensBuilder\n\n// create agens session\nval agens = AgensBuilder(spark).build\n\n// set datasource value\nval datasource = \"modern\"\n\n// for hive connected with spark\nval dbPath = \"agens\"\nagens.sql(s\"DROP DATABASE IF EXISTS $dbPath CASCADE\")\nagens.sql(\"show databases\").show\n\n// load graph\nval graphModern = agens.graph(datasource)\n\n// save graph to hive\nagens.saveGraphToHive(graphModern, datasource, dbPath)\n\n// verify database\nagens.sql(s\"show tables in $dbPath\").show","user":"anonymous","dateUpdated":"2020-09-23T10:32:16+0900","config":{"colWidth":12,"fontSize":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1600767869155_748199655","id":"20200922-184429_1773109577","dateCreated":"2020-09-22T18:44:29+0900","dateStarted":"2020-09-22T18:47:11+0900","dateFinished":"2020-09-22T18:47:19+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23043"},{"text":"// same to spark.sql\nagens.sql(s\"select * from ${dbPath}.${datasource}_vertex_person\").show","user":"anonymous","dateUpdated":"2020-09-23T10:40:15+0900","config":{"colWidth":12,"fontSize":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1600768031657_1943041635","id":"20200922-184711_1682810825","dateCreated":"2020-09-22T18:47:11+0900","dateStarted":"2020-09-22T18:49:06+0900","dateFinished":"2020-09-22T18:49:07+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23044"},{"text":"// multi-lines string\nval result = graphModern.cypher( \"\"\"|MATCH (a:person)-[r:knows]->(b)\n\t\t\t\t\t\t\t\t\t|RETURN a.name, b.name, r.weight\n\t\t\t\t\t\t\t\t\t|ORDER BY a.name\"\"\".stripMargin)\nresult.show","user":"anonymous","dateUpdated":"2020-09-23T10:40:49+0900","config":{"colWidth":12,"fontSize":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1600768121486_-1826935473","id":"20200922-184841_1335192169","dateCreated":"2020-09-22T18:48:41+0900","dateStarted":"2020-09-22T18:52:30+0900","dateFinished":"2020-09-22T18:52:35+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23045"},{"text":"// Spark SQL: temp Table => managed Table\nval df = result.asDataFrame\nval tblName = \"modern_temp3\"\n// deprecated: registerTempTable\ndf.createOrReplaceTempView(tblName)\n// create managed table using avro\nagens.sql(s\"drop table if exists avro_${tblName}\")\nagens.sql(s\"create table avro_${tblName} stored as avro as select * from ${tblName}\")\nagens.sql(s\"select * from avro_${tblName}\").show","user":"anonymous","dateUpdated":"2020-09-23T10:32:16+0900","config":{"colWidth":12,"fontSize":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1600768350727_1893509818","id":"20200922-185230_426316134","dateCreated":"2020-09-22T18:52:30+0900","dateStarted":"2020-09-22T18:54:54+0900","dateFinished":"2020-09-22T18:54:59+0900","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23046"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1600768470406_-1709542043","id":"20200922-185430_788104549","dateCreated":"2020-09-22T18:54:30+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23047","dateUpdated":"2020-09-23T10:32:16+0900"}],"name":"agens-spark-ex02","id":"2FJ3YSXFK","noteParams":{},"noteForms":{},"angularObjects":{"jdbc:shared_process":[],"spark:shared_process":[],"hive:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}